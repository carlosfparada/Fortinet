---


# Device Management

- name: Creation of a Device Group
  fortinet.fortianalyzer.faz_dvmdb_group:
    adom: "{{ fortigate_vdom }}"
    dvmdb_group:
      name: Group1
      os_type: unknown
      type: normal
    state: present

- name: Add the Fortigate as Group member
  fortinet.fortianalyzer.faz_dvmdb_group_objectmember:
    adom: "{{ fortigate_vdom }}"
    dvmdb_group_objectmember:
      name: "FortiGate-VM64-KVM"
      vdom: "{{ fortigate_vdom }}"
    group: Group1
    state: present

# Get facts

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        selector: dvmdb_adom
        # selector: dvmdb_group


- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        selector: dvmdb_adom
        # selector: dvmdb_group
        

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        # selector: cli_system_admin_setting
        # selector: cli_system_admin_user
        # selector: sys_status
        params:
            adom: "{{ fortigate_vdom }}"
            device: ""

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_fmupdate_analyzer_virusreport
        # selector: cli_system_admin_user
        # selector: sys_status


- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_fmupdate_service
        # selector: cli_system_admin_user
        # selector: sys_status

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_admin_user
        # selector: sys_status

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: sys_status

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_connector

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_dns

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_fortiview_setting

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_global

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_interface
        params:
          interface: port1


- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_locallog_setting

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_locallog_disk_setting

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_locallog_fortianalyzer_filter

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_locallog_fortianalyzer_setting

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_log_settings

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_log_alert

- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_log_interfacestats
  
- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_performance
  
- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_report_setting
  
- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: cli_system_status
  
- name: Get FortiAnalyzer facts
  fortinet.fortianalyzer.faz_fact:
    facts:
        #selector: dvmdb_device
        # selector: dvmdb_adom
        # selector: dvmdb_group
        selector: sys_status
  


